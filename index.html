<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OSCER Bingo Card Generator</title>
  <style>
    /* General Styling */
    body {
      font-family: 'Arial', sans-serif;
      text-align: center;
      margin: 20px;
      transition: background-color 0.3s, color 0.3s;
    }
    h1 {
      margin-top: 20px;
      font-size: 32px;
      text-transform: uppercase;
      font-weight: bold;
      letter-spacing: 2px;
      transition: color 0.3s, text-shadow 0.3s;
    }
    #controls {
      margin-bottom: 20px;
    }
    button {
      padding: 12px 20px;
      font-size: 16px;
      margin: 10px;
      border: none;
      cursor: pointer;
      border-radius: 5px;
      transition: transform 0.3s, background 0.3s;
      box-shadow: 0px 4px 8px rgba(0,0,0,0.2);
    }
    button:hover {
      transform: scale(1.05);
    }
    select {
      padding: 8px;
      font-size: 16px;
      border-radius: 5px;
      border: 1px solid #ccc;
      margin-left: 10px;
    }
    /* Table Styling */
    #bingo-table {
      margin: 20px auto;
      border-collapse: collapse;
      width: 90%;
      max-width: 500px;
      border-radius: 8px;
      overflow: hidden;
    }
    th, td {
      border: 2px solid;
      text-align: center;
      font-size: 16px;
      cursor: pointer;
      transition: background 0.2s, transform 0.2s;
      padding: 8px;
      vertical-align: middle;
      /* Minimum sizes to help maintain a grid */
      min-width: 80px;
      min-height: 60px;
      word-wrap: break-word;
    }
    th {
      font-weight: bold;
      letter-spacing: 1px;
      transition: background 0.3s, color 0.3s;
    }
    td.free-space {
      font-size: 18px;
      font-weight: bold;
    }
    td.marked {
      font-weight: bold;
      transform: scale(1.05);
    }
    td.bingo {
      animation: glow 1s infinite alternate;
    }
    @keyframes glow {
      0% { box-shadow: 0 0 10px rgba(255,215,0,0.5); }
      100% { box-shadow: 0 0 20px rgba(255,215,0,0.9); }
    }
    /* Modal for Bingo Celebration */
    #bingoModal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.8);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    #bingoModal #bingoMessage {
      font-size: 48px;
      font-weight: bold;
      transition: color 0.3s, text-shadow 0.3s;
    }
    /* Themes */
    .theme-classic {
      background-color: #1c1c1c;
      color: #ffd700;
    }
    .theme-classic h1 { color: #ffd700; text-shadow: 2px 2px 5px rgba(255,215,0,0.6); }
    .theme-classic button {
      background: linear-gradient(45deg, #ffd700, #e5c100);
      color: black;
    }
    .theme-classic #bingo-table {
      background-color: #222;
      border: 2px solid #ffd700;
    }
    .theme-classic th {
      background-color: #ffd700;
      color: black;
    }
    .theme-classic td {
      background-color: #1c1c1c;
      color: #fff;
    }
    .theme-classic td.free-space { background-color: #ffd700; color: black; }
    #bingoModal.theme-classic #bingoMessage { color: #ffd700; text-shadow: 2px 2px 10px rgba(255,215,0,0.8); }
    
    .theme-modern {
      background-color: #2c2c2c;
      color: #c0c0c0;
    }
    .theme-modern h1 { color: #e60000; text-shadow: 2px 2px 5px rgba(230,0,0,0.6); }
    .theme-modern button {
      background: linear-gradient(45deg, #e60000, #c70000);
      color: white;
    }
    .theme-modern #bingo-table {
      background-color: #3d3d3d;
      border: 2px solid #c0c0c0;
    }
    .theme-modern th { background-color: #c0c0c0; color: black; }
    .theme-modern td { background-color: #2c2c2c; color: #c0c0c0; }
    .theme-modern td.free-space { background-color: #c0c0c0; color: black; }
    #bingoModal.theme-modern #bingoMessage { color: #e60000; text-shadow: 2px 2px 10px rgba(230,0,0,0.8); }
    
    .theme-silent {
      background-color: #f4ecd8;
      color: #5b4636;
    }
    .theme-silent h1 { color: #5b4636; text-shadow: 2px 2px 5px rgba(91,70,54,0.6); }
    .theme-silent button {
      background: linear-gradient(45deg, #c49e70, #a57c50);
      color: white;
    }
    .theme-silent #bingo-table {
      background-color: #fdf6e3;
      border: 2px solid #5b4636;
    }
    .theme-silent th { background-color: #5b4636; color: white; }
    .theme-silent td { background-color: #fdf6e3; color: #5b4636; }
    .theme-silent td.free-space { background-color: #5b4636; color: white; }
    #bingoModal.theme-silent #bingoMessage { color: #5b4636; text-shadow: 2px 2px 10px rgba(91,70,54,0.8); }
    
    /* Mobile Optimization */
    @media (max-width: 600px) {
      th, td {
        font-size: 14px;
        padding: 6px;
        min-width: 60px;
        min-height: 50px;
      }
      button, select {
        font-size: 14px;
        padding: 10px;
      }
    }
  </style>
</head>
<body class="theme-classic">
  <h1>OSCER Bingo Card Generator</h1>
  <div id="controls">
    <button onclick="generateBingoCard()">Generate New Card</button>
    <button onclick="saveAndShare()">Save & Share</button>
    <select id="themeSelector" onchange="changeTheme(this.value)">
      <option value="classic">Classic Oscars (Gold & Black)</option>
      <option value="modern">Modern Red Carpet (Red & Silver)</option>
      <option value="silent">Silent Film Era (Sepia & Vintage)</option>
    </select>
  </div>
  <div id="bingoContainer">
    <table id="bingo-table">
      <thead>
        <tr>
          <th>O</th>
          <th>S</th>
          <th>C</th>
          <th>E</th>
          <th>R</th>
        </tr>
      </thead>
      <tbody>
        <!-- Bingo card cells will be generated here -->
      </tbody>
    </table>
  </div>
  
  <!-- Modal overlay for Bingo Celebration -->
  <div id="bingoModal" class="theme-classic">
    <div id="bingoMessage">Bingo!</div>
  </div>
  
  <!-- Audio for bingo chime and click -->
  <audio id="bingoSound" src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg"></audio>
  <audio id="clickSound" src="https://actions.google.com/sounds/v1/cartoon/pop.ogg" preload="auto"></audio>
  
  <!-- Include html2canvas for saving the card -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <!-- Include canvas-confetti for confetti effect -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
  
  <script>
    // FULL SET OF BINGO OPTIONS – Combining your supplied options and additional ideas.
    // Tier 1 (Most Likely – 30 items)
    const tier1 = [
      "Tim mentions his latest ailment",
      "Gregg does an impression",
      "Joe Estevez makes an appearance",
      "Tim threatens to cancel the show",
      "Gregg talks about The Hobbit",
      "Cutaway: Steven Spielberg photo",
      "Tim announces Dekkar/DKR 5.0",
      "Gregg holds a VHS cassette",
      "Celebrity guest interview mention",
      "Tim takes the Lord's name in vain",
      "Tim complains about production problems",
      "Gregg promises a big finale",
      "Cutaway: Peter Jackson photo",
      "Tim blames the crew",
      "Reference to HEI Points",
      "Mention of the Victorville Film Archive",
      "Tim criticizes vaccines",
      "Gregg is in legal trouble",
      "Donald Trump is referenced",
      "Tim discusses AI",
      "\"LIVE via satellite\" guest appears",
      "Tim’s meltdown on stage",
      "Gregg mentions Bogart",
      "Special guest cancels last minute",
      "Tim announces a new season of Decker",
      "Tim refers to his own health issues",
      "Reference to Popcorn Classics",
      "Gregg compares movies to VHS tapes",
      "Tim threatens to shut the show down",
      "Cutaway: Woody Allen photo"
    ];
    
    // Tier 2 (Medium Likelihood – 25 items)
    const tier2 = [
      "Tim references his own fame",
      "Gregg makes an obscure movie reference",
      "Tim complains about the budget",
      "Gregg praises classic cinema",
      "Tim mentions legal issues",
      "Guest appears in unexpected costume",
      "Mention of Tim’s skin cancer",
      "Gregg delivers a deadpan remark",
      "Tim makes a political reference",
      "Behind-the-scenes error is shown",
      "Tim cites a production mishap",
      "Gregg references John Wayne",
      "Tim interrupts a segment",
      "Recurring character makes a cameo",
      "Tim gets frustrated with the camera",
      "Gregg shares obscure film trivia",
      "Tim mentions an upcoming film",
      "Cutaway: Unrelated viral video",
      "Tim announces a surprising twist",
      "Gregg shows off his film knowledge",
      "Reference to outdated film equipment",
      "Tim shares a personal anecdote",
      "Gregg debates movie ratings",
      "Tim reminisces about his childhood",
      "Gregg mentions a cult classic"
    ];
    
    // Tier 3 (Less Likely – 20 items)
    const tier3 = [
      "Reference to a notorious on-set moment",
      "Tim insults a guest",
      "Gregg corrects Tim’s movie facts",
      "Heated exchange between Tim and Gregg",
      "Tim tells a bizarre tangential story",
      "Gregg makes a snarky pop culture comment",
      "Mention of an obscure actor",
      "Tim’s attempt at humor falls flat",
      "Gregg gives a signature deadpan stare",
      "Tim announces a new segment",
      "Gregg dismisses a film suggestion",
      "Reference to Tim’s failed project",
      "Tim reminisces about old Hollywood",
      "Gregg cites a classic film line",
      "A guest unexpectedly interrupts the broadcast",
      "Tim’s awkward silence",
      "Gregg smirks during a segment",
      "Tim mentions a technical glitch",
      "Gregg corrects a historical error",
      "A random absurd moment occurs"
    ];
    
    // Build a weighted selection pool from the three tiers.
    function buildWeightedPool() {
      const pool = [];
      tier1.forEach(option => pool.push(...Array(3).fill(option))); // Weight 3 for Tier 1
      tier2.forEach(option => pool.push(...Array(2).fill(option))); // Weight 2 for Tier 2
      tier3.forEach(option => pool.push(option)); // Weight 1 for Tier 3
      return pool;
    }
    
    // Select 24 unique items from the weighted pool.
    function weightedSelect(count) {
      let pool = buildWeightedPool();
      const result = [];
      while (result.length < count && pool.length > 0) {
        const idx = Math.floor(Math.random() * pool.length);
        const selected = pool[idx];
        pool = pool.filter(item => item !== selected); // Remove all occurrences to ensure uniqueness.
        result.push(selected);
      }
      return result;
    }
    
    // Check for a winning bingo line.
    function checkBingo() {
      const rows = document.querySelectorAll("#bingo-table tbody tr");
      const grid = [...rows].map(row => [...row.children]);
      let bingoFound = false;
    
      // Check rows and columns.
      for (let i = 0; i < 5; i++) {
        if (grid[i].every(td => td.classList.contains("marked"))) {
          highlightBingo(grid[i]);
          bingoFound = true;
        }
        const colCells = grid.map(row => row[i]);
        if (colCells.every(td => td.classList.contains("marked"))) {
          highlightBingo(colCells);
          bingoFound = true;
        }
      }
    
      // Check diagonals.
      const diag1 = [0,1,2,3,4].map(i => grid[i][i]);
      const diag2 = [0,1,2,3,4].map(i => grid[i][4-i]);
      if (diag1.every(td => td.classList.contains("marked"))) {
        highlightBingo(diag1);
        bingoFound = true;
      }
      if (diag2.every(td => td.classList.contains("marked"))) {
        highlightBingo(diag2);
        bingoFound = true;
      }
    
      if (bingoFound) {
        triggerBingoCelebration();
      }
    }
    
    // Highlight winning squares with the "bingo" class.
    function highlightBingo(cells) {
      cells.forEach(td => td.classList.add("bingo"));
    }
    
    // Trigger the Bingo celebration: play sound, show modal, launch confetti.
    function triggerBingoCelebration() {
      document.getElementById("bingoSound").play();
      const modal = document.getElementById("bingoModal");
      modal.style.display = "flex";
      setTimeout(() => { modal.style.display = "none"; }, 2000);
      confetti({
        particleCount: 100,
        spread: 70,
        origin: { y: 0.6 }
      });
    }
    
    // Generate a 5x5 bingo card (center cell shows 🍿).
    function generateBingoCard() {
      const tbody = document.querySelector("#bingo-table tbody");
      tbody.innerHTML = "";
      const totalCells = 25;
      const numItems = totalCells - 1; // Reserve center for free space.
      const items = weightedSelect(numItems);
      let itemIndex = 0;
    
      for (let row = 0; row < 5; row++) {
        const tr = document.createElement("tr");
        for (let col = 0; col < 5; col++) {
          const td = document.createElement("td");
          td.onclick = () => {
            // Play click sound.
            const clickAudio = document.getElementById("clickSound");
            clickAudio.currentTime = 0;
            clickAudio.play();
    
            // Toggle marking.
            td.classList.toggle("marked");
            if (!td.classList.contains("marked")) {
              td.classList.remove("bingo");
            }
            checkBingo();
          };
          if (row === 2 && col === 2) {
            td.textContent = "🍿";
            td.classList.add("free-space", "marked");
          } else {
            td.textContent = items[itemIndex] || "";
            itemIndex++;
          }
          tr.appendChild(td);
        }
        tbody.appendChild(tr);
      }
    }
    
    // Change the theme based on the selector.
    function changeTheme(theme) {
      document.body.classList.remove("theme-classic", "theme-modern", "theme-silent");
      document.getElementById("bingoModal").classList.remove("theme-classic", "theme-modern", "theme-silent");
      if (theme === "classic") {
        document.body.classList.add("theme-classic");
        document.getElementById("bingoModal").classList.add("theme-classic");
      } else if (theme === "modern") {
        document.body.classList.add("theme-modern");
        document.getElementById("bingoModal").classList.add("theme-modern");
      } else if (theme === "silent") {
        document.body.classList.add("theme-silent");
        document.getElementById("bingoModal").classList.add("theme-silent");
      }
    }
    
    // Use html2canvas to capture the bingo card and prompt download.
    function saveAndShare() {
      html2canvas(document.getElementById("bingo-table")).then(canvas => {
        const dataURL = canvas.toDataURL();
        const link = document.createElement("a");
        link.href = dataURL;
        link.download = "oscer_bingo_card.png";
        link.click();
      });
    }
    
    // Initialize on load.
    document.addEventListener("DOMContentLoaded", () => {
      generateBingoCard();
      changeTheme(document.getElementById("themeSelector").value);
    });
  </script>
</body>
</html>